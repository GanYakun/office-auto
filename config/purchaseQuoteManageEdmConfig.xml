<ofbiz-edm xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:noNamespaceSchemaLocation="https://dev.odatalab.com/dtds/edmconfig.xsd" ImportGlobal="false">

    <!--PurchaseQuote-->
    <EntityType Name="PurchaseQuote" OfbizEntity="Quote" EntityCondition="quoteTypeId=PURCHASE_QUOTE" EntitySetName="PurchaseQuotes" AutoProperties="true" AutoSet="true"
                Handler="component://bf-demo/groovyScripts/marketingSalesService/quote/generateEntityListFields.groovy">
        <LineItem>
            <DataField Values="quoteId,quoteName,partyId,custRequestId,salesChannelEnumId" Importance="High"/>
            <DataField Values="statusId" Criticality="statusColor" Importance="High"/>
            <Criticality Value="statusColor"/>
        </LineItem>

        <HeaderInfo TypeName="报价" TypeNamePlural="报价列表">
            <Title Path="quoteId"/>
            <Description Path="quoteName"/>
        </HeaderInfo>

        <FieldGroup Label="BaseInfo" Qualifier="BaseInfo">
            <DataField Values="partyId,salesChannelEnumId,custRequestId" Importance="High"/>
        </FieldGroup>

        <Property Name="partyId" ExcludeFromNavigationContext="true"/>

        <SelectionFields PropertyPath="quoteId,partyId,statusId"/>

        <Property Name="salesChannelEnumId">
            <Text Path="SalesChannelEnumeration/description" TextArrangement="TextOnly"/>
        </Property>
        <Property Name="statusId">
            <Text Path="QuoteStatusItem/description" TextArrangement="TextOnly"/>
            <ValueList CollectionPath="QuoteStatusItems" WithFixedValues="true"/>
        </Property>
        <Property Name="partyId">
            <Text Path="Supplier/partyName" TextArrangement="TextOnly"/>
            <ValueList CollectionPath="Suppliers"/>
        </Property>
        <Property Name="statusColor"  Type="numeric" Hidden="true" HiddenFilter="true"/>

        <NavigationProperty Name="QuoteStatusItem" Type="QuoteStatusItem" Relations="StatusItem"/>
        <NavigationProperty Name="SalesChannelEnumeration"/>
        <NavigationProperty Name="QuoteItem"/>
        <NavigationProperty Name="QuoteTerm"/>
        <NavigationProperty Name="Supplier" Type="Supplier" Relations="Party"/>
        <NavigationProperty Name="PurchaseRequest" Type="PurchaseRequest" Relations="CustRequest" IsCollection="false"/>
    </EntityType>

    <EntityType Name="QuoteTerm" AutoProperties="true" EntitySetName="QuoteTerms" AutoSet="true">
        <LineItem Qualifier="QuoteTermLineItem">
            <DataField Values="termTypeId,termValue,termDays,description,uomId" Importance="High"/>
        </LineItem>
        <Property Name="termTypeId">
            <Text Path="TermType/description" TextArrangement="TextOnly"/>
        </Property>
        <NavigationProperty Name="TermType"/>
    </EntityType>

    <EntityType Name="TermType" AutoProperties="true" AutoSet="true" EntitySetName="TermTypes">
        <Property Name="termTypeId">
            <Text Path="description" TextArrangement="TextOnly"/>
        </Property>
    </EntityType>

    <EntityType Name="Company" OfbizEntity="Party" AutoProperties="true" EntityCondition="PartyRole/roleTypeId=INTERNAL_ORGANIZATIO" EntitySetName="Companies" AutoSet="true">
        <Property Name="partyId">
            <Text Path="partyName" TextArrangement="TextOnly"/>
        </Property>
        <NavigationProperty Name="PartyAndContact"/>
        <NavigationProperty Name="PartyGroup"/>
    </EntityType>

    <EntityType Name="Supplier" OfbizEntity="Party" EntityCondition="PartyRole/roleTypeId=SUPPLIER" EntitySetName="Suppliers" AutoSet="true" AutoProperties="true">
        <Property Name="partyId" Label="供应商">
            <Text Path="partyName" TextArrangement="TextOnly"/>
        </Property>
        <NavigationProperty Name="PartyAndContact"/>
        <NavigationProperty Name="PartyGroup"/>
    </EntityType>

    <EntityType Name="PartyAndContact" AutoProperties="true" AutoSet="true" EntitySetName="PartyAndContacts"/>

    <EntityType Name="QuoteItem" AutoSet="true" EntitySetName="QuoteItems" AutoProperties="true">
        <LineItem Qualifier="QuoteItemLineItem">
            <DataField Values="productId,Product/productName,quantity,quoteUnitPrice,comments" Importance="High"/>
        </LineItem>

        <NavigationProperty Name="Product"/>
    </EntityType>

    <EntityType Name="PurchaseRequest" OfbizEntity="CustRequest" EntityCondition="custRequestTypeId=RF_PUR_QUOTE" AutoProperties="true" EntitySetName="PurchaseRequests" AutoSet="true">
        <Property Name="custRequestId">
            <Text Path="description" TextArrangement="TextOnly"/>
        </Property>
        <Property Name="fromPartyId">
            <Text Path="FromParty/partyName" TextArrangement="TextOnly"/>
        </Property>
        <NavigationProperty Name="FromParty"/>
    </EntityType>

    <EntityType Name="PartyGroup" AutoProperties="true" AutoSet="true" EntitySetName="PartyGroups"/>


    <EntityType Name="PartyAndContact" EntitySetName="PartyAndContacts" AutoProperties="true">
    </EntityType>

    <EntityType Name="Party" EntitySetName="Parties" AutoProperties="true" DraftEntityName="OrderPartyDraft">
        <Property Name="partyId">
            <Text Path="partyName" TextArrangement="TextOnly"/>
        </Property>
        <NavigationProperty Name="PartyAndContact"/>
    </EntityType>

    <EntityType Name="StatusItem" EntitySetName="OrderStatusItems" EntityCondition="statusTypeId=ORDER_STATUS" AutoProperties="true">
        <Property Name="statusId">
            <Text Path="description" TextArrangement="TextOnly"/>
        </Property>
        <ValueList CollectionPath="OrderStatusItems" WithFixedValues="true"/>
    </EntityType>

    <EntityType Name="Product" EntitySetName="Products" AutoProperties="true">
        <ValueList CollectionPath="Products" WithFixedValues="true"/>
        <Property Name="productId">
            <Text Path="productName" TextArrangement="TextOnly"/>
        </Property>
        <Property Name="productTypeId">
            <Text Path="ProductType/description" TextArrangement="TextOnly"/>
        </Property>
        <Property Name="quantityUomId" Label="单位">
            <Text Path="QuantityUom/description" TextArrangement="TextOnly"/>
        </Property>
        <NavigationProperty Name="ProductType"/>
        <NavigationProperty Name="QuantityUom"/>
    </EntityType>

    <EntityType Name="ProductType" EntitySetName="ProductType" AutoProperties="true">
    </EntityType>

    <EntityType Name="Uom"  EntitySetName="Uoms" AutoProperties="true"/>

    <EntityType Name="Enumeration" EntitySetName="OrderSalesEnumerations" EntityCondition="enumTypeId=ORDER_NEW_SALES_CHANNEL" AutoProperties="true">
        <ValueList CollectionPath="OrderSalesEnumerations" WithFixedValues="true" Label="选择销售渠道"/>
        <Property Name="enumId">
            <Text Path="description" TextArrangement="TextOnly"/>
        </Property>
    </EntityType>

    <EntityType Name="QuoteStatusItem" OfbizEntity="StatusItem" EntityCondition="statusTypeId=QUOTE_STATUS" AutoProperties="true" AutoSet="true" EntitySetName="QuoteStatusItems">
        <Property Name="statusId">
            <Text Path="description" TextArrangement="TextOnly"/>
        </Property>
    </EntityType>

    <EntityType Name="Enumeration" AutoProperties="true" EntityCondition="enumTypeId=ORDER_NEW_SALES_CHANNEL" EntitySetName="Enumerations" AutoSet="true">
        <Property Name="enumId">
            <Text Path="description" TextArrangement="TextOnly"/>
        </Property>
    </EntityType>

    <EntityContainer>
        <EntitySet Name="OrderStatusItems" EntityType="StatusItem" EntityCondition="statusTypeId=ORDER_STATUS"/>
        <EntitySet Name="CurrencyUoms" EntityType="Uom" EntityCondition="uomTypeId=CURRENCY_MEASURE"/>
        <!--=============================    ActionImportStart    =============================-->
        <ActionImport Name="DiscardAction" Action="DiscardAction"/>
        <!--=============================     ActionImportEnd    =============================-->
    </EntityContainer>
    <!--=====================================     CRUD Action definition Start   =====================================-->

    <Action Name="DiscardAction"/>
    <!--=====================================     CRUD Action definition End   =====================================-->


</ofbiz-edm>
