<?xml version="1.0" encoding="UTF-8"?>

<service-eca xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:noNamespaceSchemaLocation="http://ofbiz.apache.org/dtds/service-eca.xsd">

    <!-- 审批通过 -->
    <eca service="banfftech.updateParty" event="global-commit">
        <condition field-name="statusId" operator="equals" value="APPROVAL_APPROVED"/>
        <action service="updatePartyStatusToEnable" mode="sync"/>
    </eca>
    <!-- 创建WorkEffortAndPartyGroupContact后添加角色 -->
    <eca service="banfftech.createWorkEffortAndPartyGroupContact" event="return">
        <action service="banfftech.createSupplierRole" mode="sync"/>
    </eca>
    <!-- 创建WorkEffortAndPartyGroupContact后添加角色 -->
    <eca service="banfftech.createPersonAndContact" event="return">
        <action service="banfftech.createSupplierUserLogin" mode="sync"/>
    </eca>

    <!-- 审批通过 状态改为可用 -->
    <eca service="banfftech.updateWorkEffortAndPartyGroupContact" event="return">
        <condition field-name="currentStatusId" operator="equals" value="WEPR_COMPLETE"/>
        <action service="banfftech.completeSupplier" mode="sync"/>
    </eca>

</service-eca>
