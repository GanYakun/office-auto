<ofbiz-edm xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:noNamespaceSchemaLocation="https://dev.odatalab.com/dtds/edmconfig.xsd" ImportGlobal="false">
    <!-- 主对象PurchaseRequest（采购请求）-->
    <EntityType Name="PurchaseRequest" OfbizEntity="CustRequest" EntityCondition="custRequestTypeId=RF_PUR_QUOTE"
                AutoProperties="true"
                EntitySetName="PurchaseRequests" AutoSet="true">

        <!--关联到采购报价单-->
        <NavigationProperty Name="PurchaseQuote" Type="PurchaseQuote" Relations="Quote" IsCollection="true"/>
        <!--关联到产品需求单-->
        <NavigationProperty Name="ProductRequirement" Type="ProductRequirement" Relations="RequirementCustRequest/Requirement" IsCollection="true"/>

        <Action Name="CreatePurchaseRequest" IsBound="true" EntitySetPath="purchaseRequest"
                OfbizService="com.dpbird.odata.events.ActionEvents.createEntity">
            <Parameter Name="purchaseRequest" Type="PurchaseRequest" Nullable="false" IsCollection="true"/>
            <Parameter Name="reason" Type="String" Label="${Reason}"/>
        </Action>
    </EntityType>

    <EntityType Name="PurchaseQuote" OfbizEntity="Quote" EntityCondition="quoteTypeId=PURCHASE_QUOTE" EntitySetName="PurchaseQuotes"
                AutoProperties="true"
                AutoSet="true">
    </EntityType>

    <EntityType Name="ProductRequirement" OfbizEntity="Requirement" EntityCondition="requirementTypeId=PRODUCT_REQUIREMENT"
                Properties="requirementId,requirementTypeId,facilityId,productId,statusId"
                EntitySetName="ProductRequirements" AutoSet="true">
    </EntityType>
</ofbiz-edm>